Если пользователь забыл переключить раскладку, то можно сконвертировать то что ввёл.

    require 'keyboard_convertor'

    '<ht;ytd Ktjybl Bkmbx'.convert_keyboard()

    или

    '<ht;ytd Ktjybl Bkmbx'.convert_keyboard({ from: 'en', to: 'ru'})

    # Брежнев Леонид Ильич


    'Пщщв ьщктштпб акшутвы'.convert_keyboard({ from: 'ru', to: 'en'})

    # Good morning, friends


[Yandex - исправление неправильной раскладки](http://help.yandex.ru/search/?id=1074581#maybe)